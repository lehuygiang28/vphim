@startuml Create Director Flow

' Stereotypes: <<Component>>, <<Resolver>>, <<Service>>, <<Repository>>, <<Database>>
participant "CreateRegion (Next.js Admin)" as CreateRegion <<Component>>
participant "DirectorResolver" as Resolver <<Resolver>>
participant "DirectorService" as DirectorService <<Service>>
participant "DirectorRepository" as DirectorRepository <<Repository>>
database "MongoDB" as DB <<Database>>

CreateRegion -> DirectorResolver: mutation createDirector(input)
activate DirectorResolver
Resolver -> DirectorService: createDirector(input)
activate DirectorService
DirectorService -> DirectorRepository: findOne({slug})
activate DirectorRepository
DirectorRepository -> DB: Find director by slug
activate DB
DB --> DirectorDirectorRepository: director or null
deactivate DB
DirectorRepository --> DirectorService: director or null
deactivate DirectorRepository
alt slug already exists
    Service --> DirectorResolver: Throw BadRequestException (Slug exists)
else slug is unique
    DirectorService -> DirectorRepository: create({name, originalName, slug, posterUrl})
    activate DirectorRepository
    DirectorRepository -> DB: Insert director
    activate DB
    DB --> DirectorDirectorRepository: created director
    deactivate DB
    DirectorRepository --> DirectorService: created director
    deactivate DirectorRepository
    DirectorService --> DirectorResolver: newDirector
end
deactivate DirectorService
Resolver --> CreateRegion: newDirector
deactivate DirectorResolver

@enduml
