@startuml Region - Delete Region

actor User <<Actor>>
participant "RegionComponent (Next.js Admin)" as RegionComponent <<Component>>
participant "RegionResolver" as Resolver <<Resolver>>
participant "RequiredRoles Guard" as Guard <<Service>>
participant "RegionsService" as RegionsService <<Service>>
participant "RegionRepository" as RegionRepository <<Repository>>
database "MongoDB" as MongoDB <<Database>>

User -> RegionComponent: Initiates region deletion
RegionComponent -> Resolver: mutation deleteRegion(input)
activate Resolver

Resolver -> Guard: check admin role
activate Guard
alt user is admin
    Guard --> Resolver: allow
else user is not admin
    Guard --> User: throw ForbiddenException
    deactivate Resolver
    deactivate Guard
end
deactivate Guard

Resolver -> RegionsService: deleteRegion(input)
activate Service

Service -> Repo: deleteOne({_id})
activate Repo
Repo -> DB: deleteOne({_id})
activate DB
DB --> Repo: return delete result
deactivate DB
Repo --> Service: return delete result
deactivate Repo

RegionsService --> Resolver: return 1 (success)
deactivate Service
Resolver --> RegionComponent: return 1 (success)
deactivate Resolver

@enduml 